Rootkit Programming - Exercise 4

You should have recieved the following files:
 * README
 * create_sysmap.sh
 * Makefile
 * hide_processes.c
 * testprogramm.c
 * global.h

We implemented filehiding in two different ways.
First, we hook the readdir call of the proc-filesystem to hide the specified
tasks. Second, we manipulate the task_structs in such a way that they are removed from the task tree, the tasks list and from the hash table used
for quick lookup for task_structs.
Currently, once the module is loaded, it removes some task_structs from the
corresponding data structures. However, at unloading, no restoring of hidden 
task_structs is done. However, it is easily possible to disable the removal
of task_structs by commenting line 183 in hide_processes.c (where it says hide_processes();).
"insmod hide_processes.ko pids_to_hide=1234,5678" loads the module and 
hides the tasks with pids 1234 and 5678, respectively.

Rootkit Programming - Exercise 3

We hook getdents64 (resp. getdents) to hide files beginning with the prefix "rootkit_".
We simply call the original getdents-functions, and iterate over the resulting
dirents. As soon as we find an entry with d_name beginning with "rootkit_",
we "erase" it by moving the remaining part forward in memory (see code for
intuitive description).
Note that getdents64 is the function that is called in most of the cases.
We tested getdents-hook using a test program (testprogram.c).
We could also have done it by manipulating the previous item such that it 
appears to be longer and thus kind of shades the item beginning with "rootkit_".
This is, we modify d_reclen accordingly.
We've actually implemented it, but we like the other solution more.

Rootkit Programming - Exercise 2

We hook sys_read by changing the function pointer in the system call table
to a function hooked_read accepting the same parameters as the original
read function. hooked_read prints out all parameters and the result of the 
original read call.

We considered using try_module_get and put_module to avoid "unallowed unloading"
of our module. However, we ran into some troubles using these, while without 
them, everything seemed just fine. So, we abandoned it. However, you can add it
if you #define USE_MODULE_GET_PUT. That is, you can - before compilation - 
decide, whether you want to use it or not.

Rootkit Programming - Exercise 1

Note that generateSysmap.sh relies on grep and sed to transform system.map 
into a C header file.

Furthermore, for some reason Virtualbox sometimes can't compile the thing from within a shared folder.
